
#########################################
################ catch data #############
#########################################

## Annual catch data from 1950 to 2021 of chub mackerel in Korean waters (in MT)
## This data are also openly available from Statistics Korea and the FishstatJ database, which is provided by the Food and Agriculture Organization of the United Nations (FAO).

catch_data=c(15000, 19000, 19800, 21000, 26600, 18500, 13900, 12800, 5800, 1600, 2100, 1800, 4100, 5400, 2400, 7300, 
             2000, 2800, 10500, 42100, 38256,	60599,	78969,	74150,	80649,	70123,	107382,	113051,	99519,	120283,	62690,	108082,	99447,	122883,	101714,	68479,
             103511,	101337,	162828,	163617,	96297,	89738,	115619,	174684,	210442,	200481,	415003,	160448,	172925,	177540,	145908,	203717,
             141751,	122044,	184274,	135596,	101427,	143776,	187240,	117960,	94331,	138729,	125143,	102114,	127450,	131735,	133200,	103870,	141530,	101121,
             77603, 121770)

names(catch_data)<-1950:2021

#########################################
################ Length data ############
#########################################

## Length frequency data were collected from the large purse seine fishery from 2000 to 2017 by the National Institute of Fisheries Science (NIFS).
## bin width is 1 cm
## digitised from figures of previous papers (Kim et al. 2018, Jung 2019, Gim 2019), so the values have many decimal places
## in fork length (FL) cm

LengData=structure(c(0.00910681816382874, 0.00551797671697145, 0.0127720076618798, 
                     0.00476669401904835, 0.0128131746961556, 50.9958880460653, 57.0021669538617, 
                     52.9950328556374, 55.015293471777, 64.996650839407, 63.0003313142717, 
                     204.994943601279, 175.989934427174, 221.98246691126, 192.977830436627, 
                     270.978814139872, 242.971430069393, 132.993448338398, 125.99706664285, 
                     220.975955825418, 218.980458802279, 256.984981944797, 180.984057019807, 
                     117.988495495719, 65.0144586722032, 40.0001379852432, 15.9996026272185, 
                     5.00526951951562, 0.0129796481536323, 0.0040607890501894, 0.00620350798800407, 
                     0.0141934927384566, 0.0107834855922722, 0.0104020479961127, 0.0150226112237692, 
                     0.00530828582855582, 0.0144858899912013, 0.00326755167148721, 
                     0.0139220093733232, 0.0051954766790539, 0.00974910367291726, 
                     0.00473348870830528, 1.01120868672561, 0.00522714324499317, 0.00464832900026989, 
                     0.00118313243940096, 87.0070827219435, 58.0019746517944, 153.011058080971, 
                     156.007169992925, 73.0008459765043, 44.0041657937292, 133.001073684812, 
                     261.01275500987, 437.000952977484, 575.985829466204, 730.988318053384, 
                     1027.97992142642, 1029.97410589882, 1022.97201378087, 796.984585027597, 
                     655.995055511321, 438.98976373187, 456.002618092263, 328.992075283842, 
                     277.000403951568, 157.006286397762, 94.007092764492, 43.0032262975127, 
                     40.0090167899653, 16.0015249793953, 23.0028426469238, 41.0066458417166, 
                     69.0025397138582, 61.9987127194093, 71.0023359680313, 38.0016992514597, 
                     11.0020171778458, 12.0016732214196, 0.00894368033476132, 0.00629036971084999, 
                     0.00339841248672864, 0.00127947162499425, 0.000437890455488698, 
                     0.011881455125925, 0.00328170289581575, 3.00533801514951, 8.02046959881972, 
                     80.0195906750488, 78.0076387411549, 37.0045675472923, 46.005684455889, 
                     31.0125200921592, 41.0062733557385, 93.0017472961469, 328.99184935212, 
                     422.989826981701, 369.998220643675, 392.998189727413, 627.989412210994, 
                     955.990369146269, 980.980132511455, 1293.97210389651, 896.987862682085, 
                     977.975561687266, 1002.97052557448, 962.978336852755, 817.975452845839, 
                     761.984264619864, 583.989289112958, 266.998765933798, 127.998889668415, 
                     48.0021767798294, 14.009457903355, 9.00091129816381, 1.01792351140562, 
                     0.00394107699951643, 0.0188129053347138, 0.0032752666416654, 
                     0.0225816238708014, 0.0100944833290981, 0.00983348575193325, 
                     0.00277869937570616, 0.00978520934700167, 0.00750938067645785, 
                     0.0128719929037892, 0.0070632798455046, 0.00789100240143193, 
                     0.0160660255460359, 0.0120968622281716, 0.0187067618992171, 0.010454867259775, 
                     0.013175691750835, 0.00947961695723201, 0.00181819955211571, 
                     5.00333562783693, 19.0178030772056, 44.001717721733, 110.001387183787, 
                     219.996840536268, 355.991376017683, 495.992948609478, 681.987007336826, 
                     926.979779665754, 1059.98048180665, 973.97453573886, 1074.97214292741, 
                     976.978843832479, 1019.97479954141, 1067.96716542015, 748.987009036928, 
                     751.988253031346, 456.987990983062, 198.996464629992, 121.996799491132, 
                     33.0148402417782, 7.01295333221852, 8.01943949393987, 0.00355047844430354, 
                     0.0136937352796152, 0.0045712724706279, 0.00250876108746607, 
                     0.0174237365195052, 0.0050541917600311, 0.00617061994941436, 
                     0.0184083170684285, 0.00134045215464067, 0.00661084390048629, 
                     0.0154816512523842, 0.0172277229914315, 0.00957120312248379, 
                     0.0133043624246786, 2.00503363698416, 1.00903787944338, 35.0076455179159, 
                     90.0015773758982, 128.99891486236, 112.000522895041, 141.002954631682, 
                     305.999246628756, 459.001618815681, 665.002497105115, 798.994100728853, 
                     913.983076398679, 1003.98335768174, 1358.97484758441, 1396.97645662299, 
                     1285.9866262551, 1395.98304714205, 1356.97509887936, 1143.97634020471, 
                     886.991702535797, 533.995461441378, 345.993119349567, 274.001523196882, 
                     185.014200844399, 225.995682848355, 146.000213879401, 63.010815908602, 
                     36.0017976838853, 5.01953921788972, 1.0041617305665, 0.00352958780758764, 
                     1.00330195205165, 0.00654706340761296, 0.0224174832960352, 0.00585510608112084, 
                     0.00233785620301035, 0.00723678596300564, 0.00296974191404625, 
                     0.00101851755005244, 0.0147527520798853, 0.0114987331295192, 
                     0.0152018227764407, 0.012204071305189, 0.00674046450958198, 0.0115521554760278, 
                     0.00872646287094179, 0.0163177564802733, 1.00490742088955, 3.00584683572796, 
                     25.0150761608824, 80.99930522737, 149.995581927683, 241.994134782003, 
                     307.002696642886, 338.990041142009, 509.980943791485, 729.986403345358, 
                     980.96437835915, 1119.96884850272, 1254.95714770264, 1147.95683151932, 
                     952.982551304235, 542.984225348305, 212.997680671052, 107.012226153357, 
                     88.0148202027003, 42.0068829560038, 26.0049092918279, 19.0001385859746, 
                     14.0161291706715, 20.0053389193133, 16.0000080668728, 0.000802939355636675, 
                     1.01529677705252, 0.0092884457601585, 0.00243429434508454, 0.00706348585812744, 
                     0.0132301227620082, 0.000169894692225352, 0.00664727355794081, 
                     0.00557579153227736, 0.00197927222106108, 0.0102819387586357, 
                     1.00176198787826, 2.00690136244461, 6.00202432901376, 25.0092654917373, 
                     37.0095214849242, 40.0015817945523, 24.000294929569, 48.0023175226059, 
                     94.0119561722584, 186.007094512631, 340.999606456048, 400.99794451071, 
                     508.990622004496, 765.986518507036, 1032.98882116424, 1068.97881337076, 
                     1058.97581017133, 796.982554390253, 814.985211417264, 801.983107399852, 
                     739.985664204988, 642.995329928142, 356.991916304921, 229.995072355441, 
                     88.0029095480844, 65.0032400828204, 43.0036997755931, 15.0074926263047, 
                     6.0133664299113, 2.00108917100398, 0.00290140331071062, 0.00606749561899627, 
                     1.00569920915735, 0.0100489416348262, 0.00224603525865182, 0.0120509526666003, 
                     0.0077782369320945, 0.0138594678233862, 1.84826148738998e-06, 
                     0.0037599626249073, 0.00209702032721553, 0.00706406397924894, 
                     0.0152995755581909, 0.00548497110974033, 0.00473044983059334, 
                     0.00142836859995219, 0.00531838631835017, 5.00194854044095, 20.0043808363628, 
                     57.9989426216733, 109.003048321553, 134.009408146472, 246.006564651594, 
                     381.999224758335, 734.995963721759, 890.980388697683, 1190.99029401764, 
                     1428.97483180412, 1403.97625660182, 1259.97263713937, 1115.99334592202, 
                     1059.9815465564, 786.993346351533, 675.995582697304, 564.994522113052, 
                     308.004620471899, 160.000504132531, 114.999742519747, 90.0137551430318, 
                     45.0100608237844, 18.0009677304123, 19.0006802275142, 9.0019332207397, 
                     4.01169706054588, 2.01076142982845, 0.00545966777873241, 0.00763765865466334, 
                     0.00369236456514061, 0.00267251690912289, 0.00245296663499396, 
                     0.00594576794638901, 0.0033533706597183, 6.00460434375539, 32.0035587375589, 
                     66.01129392936, 120.002346650588, 143.008805210994, 89.0018772388417, 
                     89.9978965728293, 152.001641069664, 93.0076861805755, 105.004839361132, 
                     130.996680557592, 206.002542808274, 458.020327773676, 748.980790669966, 
                     1122.98199937243, 1016.9859257292, 762.988323013167, 1063.97716694849, 
                     942.985006465217, 933.977147696396, 996.978707310923, 1022.98196988145, 
                     607.990617592749, 588.998099988228, 606.009129000476, 322.997422255332, 
                     200.004892231618, 143.00468387707, 64.0028639949055, 32.9999754802177, 
                     14.0108520907343, 15.0026844465077, 4.00309898570804, 3.00006266200131, 
                     0.0145445063484697, 1.00367131197835, 0.0172648229499779, 0.0139986960127178, 
                     0.00809730076835456, 0.00269364439756666, 0.0108562192505864, 
                     0.00357379204241644, 0.00241030269781867, 0.00734096446448414, 
                     0.00429515875270037, 0.0254073615119915, 7.00373787221594, 11.0120616533736, 
                     25.007414157365, 40.0034829753063, 60.0044863496151, 88.0142515640511, 
                     119.010105337371, 145.007690290753, 390.00006704228, 1005.98999278892, 
                     1761.98023566878, 1973.97528505607, 2215.99177217633, 2647.96448885447, 
                     2488.97198551104, 2809.9786545551, 2763.96364315929, 2145.97958925124, 
                     1334.98305028325, 783.995534495425, 442.00145805264, 152.004526956418, 
                     87.015276896195, 49.9997249836985, 17.0122442195588, 19.0099648166671, 
                     9.0028636605805, 10.0048336398981, 11.0061693110296, 2.0063129901958, 
                     7.00042849176535, 6.00728638227538, 0.00168189688478195, 1.02892232674425, 
                     0.00447130732006308, 0.00852138583547652, 0.00475606058887162, 
                     0.0142170948966791, 0.0113179875525268, 0.0120544077427773, 1.01391686533402, 
                     0.0138572368242988, 0.00421401418440065, 0.0118259251843917, 
                     1.01504792535176, 3.00942312229872, 3.00599969395107, 19.0115896721413, 
                     94.0007653991191, 323.002167905471, 698.993094410434, 991.975554985149, 
                     1104.97212924455, 1010.97546152209, 1095.97506521488, 1328.97068835977, 
                     996.981091498924, 1113.97312999996, 1025.9800163203, 837.981519482722, 
                     567.990375809154, 432.997816572217, 303.003856062792, 269.992807877583, 
                     158.005981783823, 84.002317790347, 42.0062720762841, 39.0047732683133, 
                     34.0042459221277, 46.0083572235635, 26.0057956591977, 34.0006366079162, 
                     9.01914181797185, 6.00863407186364, 6.01041581185929, 0.00594534932291275, 
                     0.00492099947718723, 0.0128996894354848, 1.01065731794297, 0.00592940237468815, 
                     0.00139383130744937, 1.0078506773236, 6.00979562315374, 4.01180164924019, 
                     58.0003853731958, 56.9997141642621, 145.007900013632, 99.0034894343962, 
                     68.0230626324474, 78.016487690457, 117.016832594879, 330.996793852935, 
                     539.996969304502, 1070.99344379613, 1355.97924914892, 1660.97527429083, 
                     1378.98918573614, 1331.97590824973, 1252.98525989182, 1460.97737478624, 
                     1260.98019030109, 1148.98103450802, 1030.98143019525, 1012.98512684924, 
                     567.007816972996, 278.999018971188, 116.002810374097, 35.009866380476, 
                     24.0130680010687, 10.0022130445867, 5.00005353088222, 5.00901108497647, 
                     0.00840697501050964, 3.00005452638748, 3.0117351865729, 2.00278836439597, 
                     2.00477127784571, 1.00662169993535, 0.00315073152730087, 1.01076534514966, 
                     0.00596353538343421, 0.0085697863258106, 0.0101633063800449, 
                     0.00237054992067302, 0.00679408207602172, 0.0021847716621887, 
                     0.003130468055666, 0.00587905667179429, 1.01188373266379, 25.0041890129891, 
                     27.0123549484237, 47.0057408007049, 41.9999795075023, 118.008276485079, 
                     441.005780981171, 1078.0054126874, 1609.98461725805, 1747.98021320498, 
                     1891.974622129, 1721.97601591021, 2023.97183044513, 1917.98273743426, 
                     2409.97674107012, 2140.98178431642, 1882.97742196469, 1431.98176540388, 
                     1028.99898883857, 565.00457158375, 327.004637015645, 125.005600317055, 
                     40.0026113369626, 15.0061128668348, 5.00731990653126, 3.02363515173578, 
                     2.01455683634869, 2.00268717984835, 3.01015067470062, 4.00911231413622, 
                     0.00929438141883385, 0.00330134108726462, 0.0111609215688635, 
                     0.000351710723222283, 0.005448309318954, 0.00441174825200282, 
                     0.00501393921743763, 0.00756667897694545, 0.0021281941917599, 
                     0.00757873740662274, 0.00394296008030445, 0.0202029193275949, 
                     4.01012229456721, 5.00783153171831, 1.00266929462031, 13.0006428550796, 
                     60.0073513047508, 194.00440678528, 373.002183979529, 578.997915019984, 
                     817.988023511642, 1073.9835617686, 1337.97810744578, 1439.97650986415, 
                     1445.97985695979, 1906.9789259386, 2003.97348569544, 1754.97774727742, 
                     1091.98226607736, 561.99687206929, 496.99841109086, 295.998004443321, 
                     220.000019684028, 99.0066036272419, 51.0081607281345, 26.0115492322125, 
                     11.002028357248, 13.0058680252771, 6.009786777161, 5.00084078664554, 
                     3.0060773344195, 2.00060814726935, 3.01598737274115, 2.00536048690471, 
                     1.01644242176014, 0.00838960034925662, 0.00653703338532278, 0.000904463058496453, 
                     0.00654775826875041, 0.0254090375614454, 0.00039318478891496, 
                     0.0052552213250004, 0.00587265993329913, 0.00710587001934794, 
                     0.00168591191738524, 0.018007828307461, 1.00253879390264, 3.0148653266666, 
                     16.0034500241167, 39.0027155791251, 54.0016116243005, 165.021722192782, 
                     549.002527400119, 848.972510476681, 1032.96723287187, 1152.97125013896, 
                     1013.98045443643, 1041.97008012504, 1228.96402205324, 1143.96561318788, 
                     744.981846545018, 473.990204667955, 392.994007552647, 249.015168640826, 
                     167.000104613536, 74.0043334217863, 23.0056790373007, 14.0154839339522, 
                     5.0042377335069, 2.00364115136015, 0.00463338279174926, 0.0170940038788861, 
                     0.0109335300687803, 0.0096882513487854, 0.00211002757804122, 
                     1.00388776870297, 0.00724952348110901, 0.00862907714316169, 0.00929097082743932, 
                     0.00804910768983038, 0.0103786151549972, 0.0164136028708616, 
                     0.00659707795487789, 0.0113987127339591, 0.00647171658704912, 
                     2.0252020448395e-06, 1.02011324527581, 0.0131045560210898, 3.00217306679679, 
                     10.0101025417859, 31.010673379922, 40.0126518634376, 81.0149928683523, 
                     190.009873160216, 491.993212941352, 881.984314904292, 1707.9693258652, 
                     2821.94724134919, 2317.9587093484, 2045.97651953198, 2753.95582830766, 
                     2399.96476320212, 2003.97291612626, 1176.99636775587, 825.988039280696, 
                     392.002598161938, 218.011192494065, 103.012669739603, 68.0003133435533, 
                     25.0106109535135, 13.9998413414949, 3.00741288397283, 2.01457935572174, 
                     0.0101574867785351, 3.00756912716451, 2.00409071972764, 2.0022517410923, 
                     1.00226692552066, 0.0178099413963671, 0.0285464685725046, 0.00785516286031073, 
                     0.0103789327601361, 0.00745546744895945, 0.0125142141973301, 
                     0.000965313179201352, 0.00389795599952403, 1.00692354450688, 
                     12.0072472275411, 25.0004755867985, 28.0007468323226, 32.0064427008982, 
                     41.9999189665675, 71.0090435075753, 102.003086632834, 261.007160080556, 
                     317.00961489777, 811.994829935927, 958.997094718118, 1587.98860377134, 
                     2583.96762095786, 2875.98177210421, 2587.97381466434, 3621.96808958054, 
                     2356.9982533283, 1744.98359103276, 857.994637346749, 817.991595345496, 
                     456.994644104758, 306.006405631394, 194.999732405577, 122.999765488579, 
                     47.0042703992976, 18.0030808173576, 14.0032629097088, 5.0001231187773, 
                     4.00875597327814, 5.01149633977268, 0.0036139858565053, 1.00394819127961, 
                     1.01005620594278, 0.00556466856876073, 0.0163985467008666, 0.00310656655981103, 
                     0.00275764900124796, 0.0129639263455314, 0.000547506077323564, 
                     0.00573584435337311, 1.0049523467765, 0.00167128861620864, 0.000140795856527016, 
                     10.019217389416, 47.0000678310781, 135.005964087822, 171.0136957214, 
                     363.005800208516, 632.012850517269, 1173.00069177043, 1038.99317631661, 
                     1892.98616842889, 1930.99013415967, 2449.99022003476, 2704.9889648401, 
                     2492.98070653836, 2594.97850058345, 3529.97191432897, 2526.98558202239, 
                     2073.99146297484, 1153.99447039752, 1580.98828641347, 831.998111663717, 
                     496.013382075926, 276.001014639691, 125.006176312247, 94.0064064711514, 
                     53.0065740667466, 31.0016300540639, 43.0180066694145, 16.0014779383531, 
                     17.0035457702013, 3.00648360031275, 1.00259180734761, 0.0029341857338685, 
                     7.4965446128404e-05, 0.00120986885035455, 1.00373598880742), dim = c(42L, 
                                                                                          18L), dimnames = list(c("10.5", "11.5", "12.5", "13.5", "14.5", 
                                                                                                                  "15.5", "16.5", "17.5", "18.5", "19.5", "20.5", "21.5", "22.5", 
                                                                                                                  "23.5", "24.5", "25.5", "26.5", "27.5", "28.5", "29.5", "30.5", 
                                                                                                                  "31.5", "32.5", "33.5", "34.5", "35.5", "36.5", "37.5", "38.5", 
                                                                                                                  "39.5", "40.5", "41.5", "42.5", "43.5", "44.5", "45.5", "46.5", 
                                                                                                                  "47.5", "48.5", "49.5", "50.5", "51.5"), c("2000", "2001", "2002", 
                                                                                                                                                             "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", 
                                                                                                                                                             "2011", "2012", "2013", "2014", "2015", "2016", "2017")))
## round the values to 0 decimal places as the data are counts
LengData=round(LengData,0)

#########################################
################ CPUE data ##############
#########################################

## CPUE data were collected from the large purse seine fishery from 1976 to 2019 by the National Institute of Fisheries Science (NIFS).
## digitised from figures of previous papers (Kim et al. 2018, Jung 2019, Gim 2019), so the values have many decimal places
## CPUE unit is kg per haul

It_data=c(27.2993135803913, 19.2884005356802, 16.4938989223193, 17.992743867666, 
          10.3880816720222, 13.0999693043573, 10.0005393429222, 11.409321081935, 
          7.94249830978337, 3.87319709692927, 7.7533198200701, 8.5184185935698, 
          12.7888203955562, 14.4574912635227, 10.1049042849123, 12.0219744991699, 
          12.4745696309464, 15.0585717135614, 17.4364665132142, 12.6570544207245, 
          32.444891326341, 16.1958631286179, 18.1598401516598, 16.731888426176, 
          12.7891850888032, 16.6163374125783, 14.2191555657274, 15.2593955794828, 
          22.3156056089582, 15.7514114823237, 12.6409898063951, 18.927325401094, 
          27.47496901923, 26.2218444591394, 17.7532551514377, 26.9455337039349, 
          25.1099160193169, 19.3225535840596, 21.5594859290561, 21.0793562339259, 
          20.1555442077296, 16.4656229589435, 29.6865335365337, 26.3773594317103)

## round to 2 decimal places for computational efficiency in our analysis
It_data=round(It_data,2)

names(It_data) <-1976:2019



############################################################################################################################################
 
############################################################################################################################################

## number of age groups (0 to 5)
A=6 

## number of years
nyears=length(catch_data)

## length-weight relationship from Gim and Hyun 2019
alpha=0.003*1e-6 #(in MT)
beta=3.425

## maturity from Kim et al. 2020
mat1=20.11
mat2=0.70

## length bins
bins=10.5:51.5


SpawningTimeElapse=0.5
FemaleProp=0.5
LengthFreqYears=50:67
cpueYears=26:69
ncpue=44
nLengthFreq=18


## mean lengths from Jung et al. 2021
MeanLengths=c(23.9, 27.8, 30.6, 34.8, 37.2, 40.1, 42.7)

## Maturity
Maturity=1/( 1+exp(mat1-mat2*MeanLengths[1:A]))

## Length-weight
LengthWeight=alpha*MeanLengths[1:A]^beta


#############################################################################################################################################################################################################
#############################################################################################################################################################################################################
#############################################################################################################################################################################################################

## Estimating length-at-age probability distributions in catch using skew normal distributions

## packages for estimating the parameters of the skew normal distribution
require(sn)
require(rootSolve)

binwidth=bins[2]-bins[1]


## model for multiroot function
model <- function(x, parms) {
  omega = x[1]
  alpha = x[2]
  m = parms[1]
  p5 = parms[2]
  p95 = parms[3]
  xi = m - omega*alpha*sqrt(2/(pi*(1+alpha^2)))
  c(F1 = p5 - qsn(0.05, xi, omega, alpha),
    F2 = p95 - qsn(0.95, xi, omega, alpha))
}


## using multiroot function from rootSolve package to estimate the parameters of the skew normal distribution
AgeSkewNorm <-function(x, parms) {
  
  sol = multiroot(model, x, parms=parms)
  
  mean=parms[1]
  
  omega=sol$root[1]
  
  alpha=sol$root[2]
  
  xi=mean - omega*alpha*sqrt(2/(pi*(1+alpha^2)))
  
  return(list("xi"=xi,
              "omega"=omega,
              "alpha"=alpha))
}



## these minimum, mean, and maximum values of length-at-age are openly available in Jung et al. 2021
Age_Mean_Quantiles=list("age0"=c(23.9, 19.1, 29),
                        "age1"=c(27.8, 23.1, 33),
                        "age2"=c(30.6, 26.1, 36),
                        "age3"=c(34.8, 30.1, 42),
                        "age4"=c(37.2, 31.1, 43),
                        "age5"=c(40.1, 35.1, 44),
                        "age6"=c(42.7, 39.1, 46))


age0=AgeSkewNorm(x=c(30, 0.4), parms=Age_Mean_Quantiles[[1]])
age1=AgeSkewNorm(x=c(30, 0.4), parms=Age_Mean_Quantiles[[2]])
age2=AgeSkewNorm(x=c(30, 0.4), parms=Age_Mean_Quantiles[[3]])
age3=AgeSkewNorm(x=c(30, 0.4), parms=Age_Mean_Quantiles[[4]])
age4=AgeSkewNorm(x=c(100, 0.5), parms=Age_Mean_Quantiles[[5]])
age5=AgeSkewNorm(x=c(200, 1.5), parms=Age_Mean_Quantiles[[6]])
age6=AgeSkewNorm(x=c(300, 2.5), parms=Age_Mean_Quantiles[[7]])

DistPars=list("age0"=unlist(age0),
              "age1"=unlist(age1),
              "age2"=unlist(age2),
              "age3"=unlist(age3),
              "age4"=unlist(age4),
              "age5"=unlist(age5),
              "age6"=unlist(age6)) 


nbins=length(bins)

AgeLengDist=matrix(0, nrow=A, ncol=nbins)

## the length-at-age probability distributions in catch using skew normal distributions
for (a in 1:A) {
  for (i in 1:nbins) {
    if(i==1) {
      AgeLengDist[a,i]=psn(bins[i]+binwidth/2, xi=DistPars[[a]]["xi"], omega=DistPars[[a]]["omega"], alpha=DistPars[[a]]["alpha"])
    } else if (i>1 | i<nbins) {
      AgeLengDist[a,i]=psn(bins[i]+binwidth/2, xi=DistPars[[a]]["xi"], omega=DistPars[[a]]["omega"], alpha=DistPars[[a]]["alpha"])-psn(bins[i]-binwidth/2, xi=DistPars[[a]]["xi"], omega=DistPars[[a]]["omega"], alpha=DistPars[[a]]["alpha"])
    } else if (i==nbins){
      AgeLengDist[a,i]=1-psn(bins[i]-binwidth/2, xi=DistPars[[a]]["xi"], omega=DistPars[[a]]["omega"], alpha=DistPars[[a]]["alpha"])
    }
  }
}

